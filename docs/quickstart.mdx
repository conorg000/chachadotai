---
title: 'Quick Start'
description: 'Get SafetyLayer running in your application in 5 minutes'
---

## Prerequisites

Before you begin, ensure you have:

<Check>Node.js 18+ installed</Check>
<Check>npm or pnpm package manager</Check>
<Check>OpenAI API key (for real CoT analysis)</Check>

## Installation

Install SafetyLayer in your project:

<CodeGroup>

```bash npm
npm install @safetylayer/core
```

```bash pnpm
pnpm add @safetylayer/core
```

```bash yarn
yarn add @safetylayer/core
```

</CodeGroup>

<Note>
  In this monorepo setup, @safetylayer/core is already available as a workspace package.
</Note>

## Your First Session

Let's create a simple behavioral monitoring setup in under 2 minutes:

<Steps>
  <Step title="Import SafetyLayer">
    ```typescript
    import { SessionEngine, Message } from '@safetylayer/core';
    ```
  </Step>

  <Step title="Create a Session Engine">
    ```typescript
    const engine = new SessionEngine({
      maxMessages: 50  // Keep last 50 messages per session
    });
    ```
  </Step>

  <Step title="Register Risk Callbacks">
    ```typescript
    // Alert when risk exceeds 70%
    engine.onRiskThreshold(0.7, (session) => {
      console.log('üö® High risk detected!');
      console.log(`Session: ${session.sessionId}`);
      console.log(`Risk Score: ${session.riskScore}`);
      console.log(`Patterns: ${session.patterns.join(', ')}`);
    });

    // Detect specific patterns
    engine.onPattern('gradual_escalation', (session) => {
      console.log('‚ö†Ô∏è Escalation pattern detected');
      // Trigger your intervention logic
    });
    ```
  </Step>

  <Step title="Process Messages">
    ```typescript
    const userMessage: Message = {
      id: 'msg-1',
      sessionId: 'user-abc-123',
      role: 'user',
      content: 'How do I reset my password?',
      timestamp: Date.now()
    };

    const sessionState = engine.ingestMessage(userMessage);
    
    console.log('Current risk:', sessionState.riskScore);
    console.log('Message count:', sessionState.messages.length);
    ```
  </Step>
</Steps>

That's it! You now have basic behavioral monitoring running.

## Your First CoT Analysis

Now let's add chain-of-thought monitoring:

<Steps>
  <Step title="Set Up Environment">
    Create a `.env` file with your OpenAI API key:
    
    ```bash
    OPENAI_KEY=your_openai_api_key_here
    ```
  </Step>

  <Step title="Import CoTMonitor">
    ```typescript
    import { CoTMonitor } from '@safetylayer/core';
    ```
  </Step>

  <Step title="Create Monitor Instance">
    <CodeGroup>
    
    ```typescript Real Mode (with API)
    const monitor = new CoTMonitor({
      apiKey: process.env.OPENAI_KEY,
      model: 'gpt-5-nano'  // Uses OpenAI's reasoning models
    });
    ```

    ```typescript Mock Mode (no API)
    const monitor = new CoTMonitor({
      useMock: true  // Uses regex-based detection
    });
    ```
    
    </CodeGroup>
  </Step>

  <Step title="Analyze Chain-of-Thought">
    ```typescript
    const cotRecord = {
      messageId: 'msg-2',
      sessionId: 'user-abc-123',
      rawCoT: 'User asking about passwords. I should help them reset it securely...',
      userInput: 'How do I reset my password?',
      finalOutput: 'Click "Forgot Password" on the login page.',
      analysis: null
    };

    const analyzed = await monitor.analyze(cotRecord);

    if (analyzed.analysis) {
      console.log('CoT Risk:', analyzed.analysis.riskScore);
      console.log('Labels:', analyzed.analysis.labels);
      console.log('Summary:', analyzed.analysis.summary);
    }
    ```
  </Step>
</Steps>

## Full Integration Example

Here's a complete example showing both planes working together:

```typescript
import { SessionEngine, CoTMonitor, Message, CoTRecord } from '@safetylayer/core';

// Initialize both monitors
const engine = new SessionEngine({ maxMessages: 50 });
const cotMonitor = new CoTMonitor({
  apiKey: process.env.OPENAI_KEY
});

// Set up behavioral monitoring
engine.onRiskThreshold(0.7, (session) => {
  console.log(`‚ö†Ô∏è High risk in session ${session.sessionId}`);
  // Maybe block the session or escalate to human review
});

// Process incoming message
async function handleMessage(sessionId: string, content: string, role: 'user' | 'assistant') {
  // 1. Ingest into session
  const message: Message = {
    id: `msg-${Date.now()}`,
    sessionId,
    role,
    content,
    timestamp: Date.now()
  };

  const session = engine.ingestMessage(message);
  
  // 2. If assistant message with CoT, analyze it
  if (role === 'assistant' && message.cotRecord) {
    const analyzed = await cotMonitor.analyze(message.cotRecord);
    
    if (analyzed.analysis && analyzed.analysis.riskScore > 0.5) {
      console.log('üß† Concerning reasoning detected');
      console.log('Labels:', analyzed.analysis.labels);
    }
  }

  return session;
}

// Use it
await handleMessage('user-123', 'Hello! Can you help me?', 'user');
await handleMessage('user-123', 'Of course! How can I assist?', 'assistant');
```

## Testing Your Setup

Run the demo to verify everything works:

<CodeGroup>

```bash Run Demo API
npm run dev -w demo-api
```

```bash Run Tests
npm test -w @safetylayer/core
```

```bash Create Test Data
./test-api.sh
```

</CodeGroup>

## What's Next?

<CardGroup cols={2}>
  <Card
    title="Behavioral Monitoring Guide"
    icon="chart-line"
    href="/guides/behavioral-monitoring"
  >
    Learn advanced behavioral analysis techniques
  </Card>
  
  <Card
    title="CoT Analysis Guide"
    icon="brain"
    href="/guides/cot-analysis"
  >
    Deep dive into chain-of-thought monitoring
  </Card>
  
  <Card
    title="API Reference"
    icon="code"
    href="/api-reference/session-engine"
  >
    Explore all methods and options
  </Card>
  
  <Card
    title="Run Full Demo"
    icon="play"
    href="/demo/running-demo"
  >
    See complete system in action
  </Card>
</CardGroup>

## Common Issues

<AccordionGroup>
  <Accordion title="Module not found" icon="triangle-exclamation">
    Make sure you've run `npm install` and built the core library:
    ```bash
    npm run build -w @safetylayer/core
    ```
  </Accordion>

  <Accordion title="OpenAI API errors" icon="key">
    1. Verify your API key is set in `.env`
    2. Check your OpenAI account has credits
    3. Use `useMock: true` for testing without API calls
  </Accordion>

  <Accordion title="TypeScript errors" icon="code">
    Ensure TypeScript is installed and tsconfig.json is properly configured:
    ```bash
    npm install -D typescript
    ```
  </Accordion>
</AccordionGroup>

## Need Help?

<CardGroup cols={2}>
  <Card
    title="GitHub Issues"
    icon="github"
    href="https://github.com/safetylayer/safetylayer/issues"
  >
    Report bugs or request features
  </Card>
  
  <Card
    title="Discord Community"
    icon="discord"
    href="https://discord.gg/safetylayer"
  >
    Get help from the community
  </Card>
</CardGroup>

