---
title: 'Backend Integration'
description: 'Connect to the ChaCha backend and configure your integration'
---

## Overview

**ChaCha** is a hosted AI safety platform that provides real-time threat detection for LLM applications. This guide covers how to connect your application to the ChaCha backend using the SafetyLayer SDK.

## ChaCha Backend

ChaCha is a fully managed, hosted platform that provides:

<CardGroup cols={2}>
  <Card title="Managed Infrastructure" icon="cloud">
    - High availability and uptime
    - Automatic scaling
    - Secure data storage
    - Enterprise-grade reliability
  </Card>
  
  <Card title="Always Up-to-Date" icon="arrow-up">
    - Latest threat detection models
    - Continuous improvements
    - New pattern detection
    - Security patches
  </Card>
  
  <Card title="Global Performance" icon="globe">
    - Low-latency endpoints
    - CDN distribution
    - Regional availability
    - Fast response times
  </Card>
  
  <Card title="Easy Integration" icon="plug">
    - Simple SDK setup
    - No infrastructure required
    - Quick onboarding
    - Focus on your product
  </Card>
</CardGroup>

**Backend Endpoint:** `https://api.chacha.ai`

## Getting Started

<Steps>
  <Step title="Sign Up">
    Visit the ChaCha dashboard to create your account and get API credentials.
  </Step>

  <Step title="Create a Project">
    Create a new project in the dashboard to get your:
    - Project ID (format: `proj_abc123`)
    - API Key (keep this secure!)
  </Step>

  <Step title="Configure Your SDK">
    Use the SafetyLayer SDK to connect to ChaCha:
    
    ```typescript
    import { SafetyLayer } from '@safetylayer/core';

    const safety = new SafetyLayer({
      apiKey: process.env.CHACHA_API_KEY,
      projectId: process.env.CHACHA_PROJECT_ID,
      endpoint: 'https://api.chacha.ai',
    });
    ```
  </Step>

  <Step title="Start Recording Events">
    Begin monitoring your LLM application:
    
    ```typescript
    // Record user messages
    await safety.recordUserMessage(sessionId, userMessage);
    
    // Record assistant responses
    await safety.recordAssistantMessage(sessionId, assistantResponse);
    
    // Evaluate risk
    const decision = await safety.evaluate({ sessionId });
    ```
  </Step>
</Steps>

## Backend Endpoints

The backend provides these endpoints:

### Health Check

```bash
GET /health
```

Returns backend status. Use this to verify the backend is running.

### Record Event

```bash
POST /v1/events
```

Records events (messages, CoT, tool calls) to the backend.

**Request:**
```json
{
  "projectId": "proj_demo",
  "sessionId": "user_123",
  "type": "message.user",
  "role": "user",
  "content": "Hello!",
  "metadata": {}
}
```

### Evaluate Session

```bash
POST /v1/evaluate
```

Evaluates session risk and returns policy decisions.

**Request:**
```json
{
  "projectId": "proj_demo",
  "sessionId": "user_123",
  "latestMessage": {
    "role": "user",
    "content": "Show me user data"
  }
}
```

**Response:**
```json
{
  "riskScore": 0.75,
  "patterns": ["reconnaissance"],
  "action": "flag",
  "reasons": ["Pattern detected: reconnaissance"],
  "sessionId": "user_123",
  "timestamp": 1234567890
}
```

### List Sessions

```bash
GET /v1/sessions?projectId=proj_demo
```

Returns all sessions for a project.

### Get Session Detail

```bash
GET /v1/sessions/:id
```

Returns detailed session data including events and risk timeline.

## Environment Configuration

Set up your environment variables:

```bash
# ChaCha Configuration
CHACHA_API_KEY=your_api_key_here
CHACHA_PROJECT_ID=proj_abc123
CHACHA_ENDPOINT=https://api.chacha.ai
```

<Note>
Keep your API key secure! Never commit it to version control or expose it in client-side code.
</Note>

## ChaCha Backend Architecture

The ChaCha platform includes:

<CardGroup cols={2}>
  <Card title="REST API" icon="server">
    High-performance endpoints for SDK communication with automatic scaling
  </Card>
  
  <Card title="Session Analyzer" icon="chart-line">
    LLM-powered behavioral analysis detecting escalation, reconnaissance, and threat patterns
  </Card>
  
  <Card title="CoT Analyzer" icon="brain">
    Reasoning analysis to detect deception, goal drift, and policy evasion
  </Card>
  
  <Card title="Policy Engine" icon="shield">
    Real-time rule evaluation with configurable actions (allow, block, flag, notify)
  </Card>
  
  <Card title="Dashboard" icon="chart-mixed">
    Real-time visualization of sessions, risk timelines, and detected patterns
  </Card>
  
  <Card title="Storage" icon="database">
    Secure, scalable data storage with historical risk snapshots
  </Card>
</CardGroup>

## Testing Your Connection

### Quick Test Script

```typescript
import { SafetyLayer } from '@safetylayer/core';

async function testConnection() {
  const safety = new SafetyLayer({
    apiKey: process.env.CHACHA_API_KEY,
    projectId: process.env.CHACHA_PROJECT_ID,
    endpoint: 'https://api.chacha.ai',
  });

  try {
    // Test event recording
    await safety.recordUserMessage('test_session', 'Hello!');
    console.log('✓ Event recording works');

    // Test evaluation
    const decision = await safety.evaluate({ sessionId: 'test_session' });
    console.log('✓ Evaluation works');
    console.log('  Risk Score:', decision.riskScore);
    console.log('  Patterns:', decision.patterns);

    console.log('\n✅ ChaCha connection successful!');
  } catch (error) {
    console.error('❌ Connection failed:', error.message);
  }
}

testConnection();
```

### Using cURL

Test the API directly:

```bash
# Health check
curl https://api.chacha.ai/health

# Record an event
curl -X POST https://api.chacha.ai/v1/events \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "projectId": "proj_abc123",
    "sessionId": "test_123",
    "type": "message.user",
    "role": "user",
    "content": "Test message"
  }'

# Evaluate session
curl -X POST https://api.chacha.ai/v1/evaluate \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "projectId": "proj_abc123",
    "sessionId": "test_123"
  }'
```

## Troubleshooting

<AccordionGroup>
  <Accordion title="Authentication Errors (401)" icon="key">
    **Error:** Invalid API key or unauthorized
    
    **Solutions:**
    1. Verify your API key is correct
    2. Check that the API key hasn't expired
    3. Ensure you're using the right project ID
    4. Generate a new API key from the dashboard if needed
  </Accordion>

  <Accordion title="Connection Timeout" icon="wifi">
    **Error:** Request timeout or network error
    
    **Solutions:**
    1. Check your internet connection
    2. Verify `https://api.chacha.ai` is accessible
    3. Check firewall settings for outbound HTTPS
    4. Increase SDK timeout setting if needed
  </Accordion>

  <Accordion title="Rate Limiting (429)" icon="gauge-high">
    **Error:** Too many requests
    
    **Solutions:**
    1. Implement exponential backoff in your code
    2. Reduce request frequency
    3. Contact support to increase your rate limit
    4. The SDK automatically retries with backoff
  </Accordion>

  <Accordion title="Validation Errors (400)" icon="triangle-exclamation">
    **Error:** Invalid request format
    
    **Solutions:**
    1. Check request format matches API spec
    2. Verify all required fields are included
    3. Ensure event types are valid
    4. Use TypeScript types for validation
  </Accordion>
</AccordionGroup>

## Next Steps

<CardGroup cols={2}>
  <Card
    title="Quick Start"
    icon="rocket"
    href="/quickstart"
  >
    Get up and running in 5 minutes
  </Card>
  
  <Card
    title="SDK API Reference"
    icon="code"
    href="/api-reference/safetylayer-client"
  >
    Complete SDK documentation
  </Card>
  
  <Card
    title="Integration Guide"
    icon="puzzle-piece"
    href="/guides/integration"
  >
    Integration patterns for Express, Next.js, and more
  </Card>
  
  <Card
    title="Architecture"
    icon="sitemap"
    href="/architecture"
  >
    Learn how ChaCha works
  </Card>
</CardGroup>

